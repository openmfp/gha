name: Check Helm Chart Docs
on:
  workflow_call:
    inputs:
      chartFolder:
        description: 'The folder where the helm chart is located'
        required: true
        default: ''
        type: string
      headerFile:
        description: 'The header file to use for the helm-docs'
        required: false
        default: '../../docs-templates/header.md.gotmpl'
        type: string
      footerFile:
        description: 'The footer file to use for the helm-docs'
        required: false
        default: '../../docs-templates/footer.md.gotmpl'
        type: string

jobs:
  docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5
      - name: Run helm-docs
        uses: losisin/helm-docs-github-action@a57fae5676e4c55a228ea654a1bcaec8dd3cf5b5 # v1
        with:
          fail-on-diff: false
          chart-search-root: ${{ inputs.chartFolder }}
          template-files: ${{ inputs.headerFile }},README.md.gotmpl,${{ inputs.footerFile }}
          git-push: false
      - run: git diff --exit-code